<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Explain Document ‚Äì ClearCourt</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />
</head>
<body class="bg-gray-100 min-h-screen p-4">

  <div class="max-w-2xl mx-auto bg-white shadow-xl rounded-xl p-6 mt-10">
    <h1 class="text-3xl font-bold mb-4 text-center text-gray-800">Document Summary</h1>
    <p class="mb-6 text-center text-gray-600">
      Here is a summary and explanation of your court document:
    </p>

    <div id="loading" class="text-center text-gray-500 mb-4">üîÑ Generating summary‚Ä¶</div>

    <pre id="summary" class="bg-gray-100 p-4 whitespace-pre-wrap rounded text-sm h-60 overflow-auto mb-4"></pre>

    <a href="upload.html" class="text-blue-600 hover:underline block text-center">‚Üê Back to Upload</a>
  </div>

  <script>
    const GEMINI_API_KEY = "AIzaSyDjz-O7bHDY6hTTj51czVHeK_b-yZL2w5I";  // Your Gemini API Key

    async function getGeminiSummary(text) {
      const endpoint = `https://generativelanguage.googleapis.com/v1beta/models/text-bison-001:generateText?key=${GEMINI_API_KEY}`;

      const requestBody = {
        prompt: {
          text: `Explain this legal document in plain English:\n\n${text}`
        },
        temperature: 0.3,
        maxOutputTokens: 512,
        topP: 0.8,
        topK: 40
      };

      const response = await fetch(endpoint, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(requestBody),
      });

      if (!response.ok) {
        const error = await response.json().catch(() => ({}));
        throw new Error(`API error: ${response.status} ‚Äì ${error.error?.message || "Unknown error"}`);
      }

      const data = await response.json();
      return data?.candidates?.[0]?.output || "No explanation returned.";
    }

    async function generateSummary() {
      const summaryEl = document.getElementById("summary");
      const loadingEl = document.getElementById("loading");
      const text = localStorage.getItem("courtText");

      if (!text) {
        summaryEl.textContent = "No document text found. Please upload and extract text first.";
        loadingEl.style.display = "none";
        return;
      }

      try {
        const summary = await getGeminiSummary(text);
        summaryEl.textContent = summary;
      } catch (err) {
        summaryEl.textContent = "Failed to get summary: " + err.message;
      } finally {
        loadingEl.style.display = "none";
      }
    }

    generateSummary(); // Run on load
  </script>
</body>
</html>


